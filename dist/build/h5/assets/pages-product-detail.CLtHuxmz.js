import{g as t,e,n as a,l as s,h as l,m as i,i as c,S as o,b as n,c as r,d,I as u}from"./index-Clh3_Y42.js";import{a6 as h,ac as p,a7 as g,N as m,aO as f,al as _,ai as C,_ as I,aV as L,aW as x}from"./vendor.BqSpu6Cs.js";import{_ as F}from"./_plugin-vue_export-helper.BCo6x5W8.js";const b=F({data:()=>({id:null,product:{name:"意大利进口羊毛面料 精选VBC面料",code:"VBC20240001",memberPrice:100,price:128,sales:359,colors:["蓝色格纹","灰色格纹","深蓝色"],specs:["1.5","2","2.5","3"],images:["/static/images/products/fabric1.jpg","/static/images/products/fabric2.jpg","/static/images/products/fabric3.jpg"],detailImages:["/static/images/products/detail1.jpg","/static/images/products/detail2.jpg"],description:"意大利VBC面料，100%羊毛，适合定制高级西装、外套等服装。面料手感柔软，垂顺度好，清晰的格纹图案彰显品味。"},selectedColor:"蓝色格纹",lengthInput:"2.0",minLength:.5,maxLength:10}),computed:{calculateTotalPrice(){return((parseFloat(this.lengthInput)||0)*(this.product.memberPrice||0)).toFixed(2)}},onLoad(t){t.id&&(this.id=t.id)},methods:{loadProductDetail(t){console.log("加载商品详情，ID：",t)},decreaseLength(){let t=parseFloat(this.lengthInput);t>this.minLength&&(t=Math.max(this.minLength,(t-.1).toFixed(1)),this.lengthInput=t.toString())},increaseLength(){let t=parseFloat(this.lengthInput);t<this.maxLength&&(t=Math.min(this.maxLength,(t+.1).toFixed(1)),this.lengthInput=t.toString())},validateLength(){let t=parseFloat(this.lengthInput);isNaN(t)&&(t=this.minLength),t=Math.max(this.minLength,Math.min(this.maxLength,t)),t=Math.round(10*t)/10,this.lengthInput=t.toFixed(1)},handleShare(){uni.showShareMenu({withShareTicket:!0})},handleAddToCart(){if(!this.selectedColor||!this.lengthInput)return void t({title:"请选择商品规格",icon:"none"});s({title:"正在加入..."});const a={id:this.product.id||this.id,name:this.product.name,image:this.product.images[0],color:this.selectedColor,length:parseFloat(this.lengthInput),unitPrice:this.product.memberPrice,selected:!1};try{const s=l("cartList")||[],c=s.findIndex((t=>t.id===a.id&&t.color===a.color));-1!==c?s[c].length=parseFloat((s[c].length+a.length).toFixed(1)):s.push(a),e("cartList",s),i(),t({title:"加入购物车成功",icon:"success",success:()=>{}})}catch(c){console.error("添加到购物车失败:",c),i(),t({title:"添加失败，请重试",icon:"error"})}},handleBuyNow(){if(!this.selectedColor)return void t({title:"请选择颜色",icon:"none"});if(!this.lengthInput)return void t({title:"请输入长度",icon:"none"});const s={items:[{id:this.product.id||this.id,name:this.product.name,image:this.product.images[0],color:this.selectedColor,length:parseFloat(this.lengthInput),unitPrice:this.product.memberPrice,subtotal:parseFloat(this.calculateTotalPrice)}],totalAmount:parseFloat(this.calculateTotalPrice),discount:0,finalAmount:parseFloat(this.calculateTotalPrice)};try{e("currentOrder",s),a({url:"/pages/order/order",success:()=>{console.log("Navigation successful")},fail:e=>{console.error("Navigation failed:",e),t({title:"页面跳转失败",icon:"error"})}})}catch(l){console.error("处理订单失败:",l),t({title:"处理订单失败，请重试",icon:"error"})}}}},[["render",function(t,e,a,s,l,i){const F=r,b=n,k=o,P=c,v=d,y=u;return g(),h(P,{class:"product-detail"},{default:p((()=>[m(k,{class:"product-swiper",circular:"","indicator-dots":"",autoplay:!1,duration:500},{default:p((()=>[(g(!0),f(_,null,C(l.product.images,((t,e)=>(g(),h(b,{key:e},{default:p((()=>[m(F,{src:t,mode:"aspectFill",class:"slide-image"},null,8,["src"])])),_:2},1024)))),128))])),_:1}),m(P,{class:"product-info card"},{default:p((()=>[m(P,{class:"product-name"},{default:p((()=>[I(L(l.product.name),1)])),_:1}),m(P,{class:"product-code"},{default:p((()=>[I("商品编号："+L(l.product.code),1)])),_:1}),m(P,{class:"price-row"},{default:p((()=>[m(P,{class:"price-info"},{default:p((()=>[m(v,{class:"member-price"},{default:p((()=>[I("¥"+L(l.product.memberPrice),1),m(v,{class:"price-unit"},{default:p((()=>[I("/m")])),_:1})])),_:1}),m(v,{class:"original-price"},{default:p((()=>[I("¥"+L(l.product.price)+"/m",1)])),_:1})])),_:1}),m(P,{class:"sales-info"},{default:p((()=>[I("销量 "+L(l.product.sales),1)])),_:1})])),_:1})])),_:1}),m(P,{class:"specs-section card"},{default:p((()=>[m(P,{class:"section-title"},{default:p((()=>[I("规格")])),_:1}),m(P,{class:"specs-list"},{default:p((()=>[m(P,{class:"spec-group"},{default:p((()=>[m(P,{class:"spec-title"},{default:p((()=>[I("颜色")])),_:1}),m(P,{class:"spec-options"},{default:p((()=>[(g(!0),f(_,null,C(l.product.colors,((t,e)=>(g(),h(P,{key:e,class:x(["spec-item",{active:l.selectedColor===t}]),onClick:e=>l.selectedColor=t},{default:p((()=>[I(L(t),1)])),_:2},1032,["class","onClick"])))),128))])),_:1})])),_:1}),m(P,{class:"spec-group"},{default:p((()=>[m(P,{class:"spec-title"},{default:p((()=>[I("长度(m)")])),_:1}),m(P,{class:"length-input-container"},{default:p((()=>[m(P,{class:"length-control",onClick:i.decreaseLength},{default:p((()=>[I("-")])),_:1},8,["onClick"]),m(y,{type:"digit",class:"length-input",modelValue:l.lengthInput,"onUpdate:modelValue":e[0]||(e[0]=t=>l.lengthInput=t),onBlur:i.validateLength},null,8,["modelValue","onBlur"]),m(P,{class:"length-control",onClick:i.increaseLength},{default:p((()=>[I("+")])),_:1},8,["onClick"])])),_:1}),m(P,{class:"length-tips"},{default:p((()=>[I("以0.1m为单位增减，最小0.5m")])),_:1})])),_:1}),m(P,{class:"total-price-section"},{default:p((()=>[m(P,{class:"spec-title"},{default:p((()=>[I("总价")])),_:1}),m(P,{class:"total-price"},{default:p((()=>[I("¥"+L(i.calculateTotalPrice),1)])),_:1})])),_:1})])),_:1})])),_:1}),m(P,{class:"detail-section card"},{default:p((()=>[m(P,{class:"section-title"},{default:p((()=>[I("商品详情")])),_:1}),m(P,{class:"detail-content"},{default:p((()=>[(g(!0),f(_,null,C(l.product.detailImages,((t,e)=>(g(),h(F,{key:e,src:t,mode:"widthFix",class:"detail-image"},null,8,["src"])))),128)),m(P,{class:"detail-text"},{default:p((()=>[I(L(l.product.description),1)])),_:1})])),_:1})])),_:1}),m(P,{class:"action-bar safe-area-bottom"},{default:p((()=>[m(P,{class:"action-left"},{default:p((()=>[m(P,{class:"action-icon",onClick:i.handleShare},{default:p((()=>[m(v,{class:"iconfont icon-share"},{default:p((()=>[I("↗️")])),_:1}),m(v,null,{default:p((()=>[I("分享")])),_:1})])),_:1},8,["onClick"])])),_:1}),m(P,{class:"action-right"},{default:p((()=>[m(P,{class:"add-cart-btn",onClick:i.handleAddToCart},{default:p((()=>[I("加入购物车")])),_:1},8,["onClick"]),m(P,{class:"buy-now-btn",onClick:i.handleBuyNow},{default:p((()=>[I("立即购买")])),_:1},8,["onClick"])])),_:1})])),_:1})])),_:1})}],["__scopeId","data-v-4de65df6"]]);export{b as default};
