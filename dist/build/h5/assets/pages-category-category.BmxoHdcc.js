import{c as e,w as t,n as a,v as o,i,r as s,o as c,b as l,g as r,F as n,h as d,x as g,f as p,t as h,y as u,d as m}from"./index-oiMriBxI.js";import{P as y,S as f}from"./index.E0XR1HLE.js";import{_ as C}from"./_plugin-vue_export-helper.BCo6x5W8.js";const b=C({components:{SearchBar:f,ProductCard:y},data:()=>({filterTabs:[{name:"综合",type:"all"},{name:"价格",type:"price"},{name:"销量",type:"sales"},{name:"推荐",type:"recommend"}],activeTabIndex:0,categoryList:[{id:0,name:"全部"},{id:1,name:"套装/裤子"},{id:2,name:"上衣"},{id:3,name:"衬衫"},{id:4,name:"马甲"},{id:5,name:"大衣"},{id:6,name:"休闲夹克/风衣"},{id:7,name:"休闲裤"},{id:8,name:"针织"}],activeCategoryIndex:0,productList:[],page:1,loading:!1,noMore:!1,keyword:"",scrollTop:0}),onLoad(e){if(console.log("Category page loaded with options:",e),e.id){const t=parseInt(e.id);console.log("Looking for category with ID:",t);const a=this.categoryList.findIndex((e=>e.id===t));console.log("Found category at index:",a),-1!==a&&(this.activeCategoryIndex=a,console.log("Set active category index to:",a),this.$nextTick((()=>{const e=o().in(this);e.select(".category-menu").boundingClientRect(),e.select(`.menu-item:nth-child(${a+1})`).boundingClientRect(),e.exec((e=>{if(e[0]&&e[1]){const t=e[0],a=e[1].top-t.top;console.log("Scrolling to position:",a),this.scrollTop=a}}))})))}this.loadProducts()},methods:{handleSearch(e){this.keyword=e,this.page=1,this.productList=[],this.noMore=!1,this.loadProducts()},handleTabClick(e){this.activeTabIndex!==e&&(this.activeTabIndex=e,this.page=1,this.productList=[],this.noMore=!1,this.loadProducts())},handleCategoryClick(e){this.activeCategoryIndex!==e&&(this.activeCategoryIndex=e,this.page=1,this.productList=[],this.noMore=!1,this.loadProducts())},handleProductClick(e){a({url:`/pages/product/detail?id=${e.id}`})},loadMore(){this.loading||this.noMore||(this.page++,this.loadProducts())},loadProducts(){this.loading||(this.loading=!0,setTimeout((()=>{const e=[{id:1,image:"/static/images/products/fabric1.jpg",name:"意大利进口羊毛面料 精选VBC面料",memberPrice:100,price:128},{id:2,image:"/static/images/products/fabric2.jpg",name:"英国进口哈里斯粗花呢面料",memberPrice:120,price:150},{id:3,image:"/static/images/products/fabric3.jpg",name:"日本进口棉麻混纺面料",memberPrice:80,price:98},{id:4,image:"/static/images/products/fabric4.jpg",name:"意大利进口真丝面料",memberPrice:200,price:258}];this.page>=3?this.noMore=!0:this.productList=[...this.productList,...e],this.loading=!1}),800))}}},[["render",function(a,o,y,f,C,b){const k=s("search-bar"),x=i,_=u,v=s("product-card");return c(),e(x,{class:"category-page"},{default:t((()=>[l(k,{placeholder:"搜索面料",onSearch:b.handleSearch},null,8,["onSearch"]),l(x,{class:"filter-tabs"},{default:t((()=>[(c(!0),r(n,null,d(C.filterTabs,((a,o)=>(c(),e(x,{key:o,class:g(["tab-item",{active:C.activeTabIndex===o}]),onClick:e=>b.handleTabClick(o)},{default:t((()=>[p(h(a.name),1)])),_:2},1032,["class","onClick"])))),128))])),_:1}),l(x,{class:"content"},{default:t((()=>[l(_,{"scroll-y":"",class:"category-menu",ref:"categoryMenu","scroll-top":C.scrollTop},{default:t((()=>[(c(!0),r(n,null,d(C.categoryList,((a,o)=>(c(),e(x,{key:o,class:g(["menu-item",{active:C.activeCategoryIndex===o}]),onClick:e=>b.handleCategoryClick(o)},{default:t((()=>[p(h(a.name),1)])),_:2},1032,["class","onClick"])))),128))])),_:1},8,["scroll-top"]),l(_,{"scroll-y":"",class:"product-list",onScrolltolower:b.loadMore},{default:t((()=>[l(x,{class:"grid-container"},{default:t((()=>[(c(!0),r(n,null,d(C.productList,((a,o)=>(c(),e(x,{class:"grid-item",key:o},{default:t((()=>[l(v,{product:a,onClick:e=>b.handleProductClick(a)},null,8,["product","onClick"])])),_:2},1024)))),128))])),_:1}),C.loading?(c(),e(x,{key:0,class:"loading"},{default:t((()=>[p("加载中...")])),_:1})):m("",!0),C.noMore?(c(),e(x,{key:1,class:"no-more"},{default:t((()=>[p("没有更多了")])),_:1})):m("",!0)])),_:1},8,["onScrolltolower"])])),_:1})])),_:1})}],["__scopeId","data-v-21282e79"]]);export{b as default};
