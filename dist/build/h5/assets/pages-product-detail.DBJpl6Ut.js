import{c as t,w as e,q as s,m as a,n as i,A as l,u as c,B as o,i as n,o as d,b as r,S as u,g as h,F as p,h as g,k as m,j as f,f as _,t as P,e as x,l as b,I}from"./index-Dz1Oxr08.js";import{_ as L}from"./_plugin-vue_export-helper.BCo6x5W8.js";const F=L({data:()=>({id:null,product:{name:"意大利进口羊毛面料 精选VBC面料",code:"VBC20240001",memberPrice:100,price:128,sales:359,images:["/static/images/products/italian-wool-main.jpg","/static/images/products/italian-wool-texture.jpg","/static/images/products/italian-wool-detail.jpg"],detailImages:["/static/images/products/italian-wool-usage1.jpg","/static/images/products/italian-wool-usage2.jpg"],description:"意大利VBC面料，100%羊毛，适合定制高级西装、外套等服装。面料手感柔软，垂顺度好，清晰的格纹图案彰显品味。"},lengthInput:"2.0",minLength:.85,maxLength:10,isWholePiece:!1}),computed:{calculateTotalPrice(){return((parseFloat(this.lengthInput)||0)*(this.product.memberPrice||0)).toFixed(2)}},onLoad(t){t.id&&(this.id=t.id)},methods:{loadProductDetail(t){console.log("加载商品详情，ID：",t)},decreaseLength(){if(this.isWholePiece)return;let t=parseFloat(this.lengthInput);t>this.minLength&&(t=Math.max(this.minLength,(t-.1).toFixed(1)),this.lengthInput=t.toString())},increaseLength(){if(this.isWholePiece)return;let t=parseFloat(this.lengthInput);t<this.maxLength&&(t=Math.min(this.maxLength,(t+.1).toFixed(1)),this.lengthInput=t.toString())},validateLength(){if(this.isWholePiece)return void(this.lengthInput=this.maxLength.toFixed(1));let t=parseFloat(this.lengthInput);isNaN(t)&&(t=this.minLength),t=Math.max(this.minLength,Math.min(this.maxLength,t)),t=Math.round(10*t)/10,this.lengthInput=t.toFixed(1)},handleAddToCart(){if(!this.lengthInput)return void s({title:"请输入长度",icon:"none"});l({title:"正在加入..."});const t={id:this.product.id||this.id,name:this.product.name,image:this.product.images[0],length:parseFloat(this.lengthInput),unitPrice:this.product.memberPrice,selected:!1};try{const e=c("cartList")||[],i=e.findIndex((e=>e.id===t.id&&e.length===t.length));-1!==i?e[i].selected=!0:e.push(t),a("cartList",e),o(),s({title:"加入购物车成功",icon:"success",success:()=>{}})}catch(e){console.error("添加到购物车失败:",e),o(),s({title:"添加失败，请重试",icon:"error"})}},handleBuyNow(){if(!this.lengthInput)return void s({title:"请输入长度",icon:"none"});const t={items:[{id:this.product.id||this.id,name:this.product.name,image:this.product.images[0],length:parseFloat(this.lengthInput),unitPrice:this.product.memberPrice,subtotal:parseFloat(this.calculateTotalPrice)}],totalAmount:parseFloat(this.calculateTotalPrice),discount:0,finalAmount:parseFloat(this.calculateTotalPrice)};try{a("currentOrder",t),i({url:"/pages/order/order",success:()=>{console.log("Navigation successful")},fail:t=>{console.error("Navigation failed:",t),s({title:"页面跳转失败",icon:"error"})}})}catch(e){console.error("处理订单失败:",e),s({title:"处理订单失败，请重试",icon:"error"})}},buyWholePiece(){this.lengthInput=this.maxLength.toFixed(1),s({title:"已设置为整块购买",icon:"success"})},toggleWholePiece(){this.isWholePiece=!this.isWholePiece,this.isWholePiece?(this.lengthInput=this.maxLength.toFixed(1),s({title:"已设置为整块购买",icon:"success"})):(this.lengthInput=this.minLength.toFixed(1),s({title:"已取消整块购买",icon:"none"}))}}},[["render",function(s,a,i,l,c,o){const L=f,F=m,C=u,W=n,w=x,k=I;return d(),t(W,{class:"product-detail"},{default:e((()=>[r(C,{class:"product-swiper",circular:"","indicator-dots":"",autoplay:!1,duration:500},{default:e((()=>[(d(!0),h(p,null,g(c.product.images,((s,a)=>(d(),t(F,{key:a},{default:e((()=>[r(L,{src:s,mode:"aspectFill",class:"slide-image"},null,8,["src"])])),_:2},1024)))),128))])),_:1}),r(W,{class:"product-info card"},{default:e((()=>[r(W,{class:"product-name"},{default:e((()=>[_(P(c.product.name),1)])),_:1}),r(W,{class:"product-code"},{default:e((()=>[_("商品编号："+P(c.product.code),1)])),_:1}),r(W,{class:"price-row"},{default:e((()=>[r(W,{class:"price-info"},{default:e((()=>[r(w,{class:"member-price"},{default:e((()=>[_("¥"+P(c.product.memberPrice),1),r(w,{class:"price-unit"},{default:e((()=>[_("/m")])),_:1})])),_:1}),r(w,{class:"original-price"},{default:e((()=>[_("¥"+P(c.product.price)+"/m",1)])),_:1})])),_:1}),r(W,{class:"sales-info"},{default:e((()=>[_("销量 "+P(c.product.sales),1)])),_:1})])),_:1})])),_:1}),r(W,{class:"specs-section card"},{default:e((()=>[r(W,{class:"section-title"},{default:e((()=>[_("长度选择")])),_:1}),r(W,{class:"specs-list"},{default:e((()=>[r(W,{class:"spec-group"},{default:e((()=>[r(W,{class:"spec-title"},{default:e((()=>[_("长度(m)")])),_:1}),r(W,{class:b(["length-input-container",{disabled:c.isWholePiece}])},{default:e((()=>[r(W,{class:b(["length-control",{disabled:c.isWholePiece}]),onClick:o.decreaseLength},{default:e((()=>[_("-")])),_:1},8,["onClick","class"]),r(k,{type:"digit",class:"length-input",modelValue:c.lengthInput,"onUpdate:modelValue":a[0]||(a[0]=t=>c.lengthInput=t),onBlur:o.validateLength,disabled:c.isWholePiece},null,8,["modelValue","onBlur","disabled"]),r(W,{class:b(["length-control",{disabled:c.isWholePiece}]),onClick:o.increaseLength},{default:e((()=>[_("+")])),_:1},8,["onClick","class"])])),_:1},8,["class"]),r(W,{class:"length-tips"},{default:e((()=>[_("以0.1m为单位增减，最小0.85m，最大"+P(c.maxLength)+"m",1)])),_:1}),r(W,{class:"buy-whole-container"},{default:e((()=>[r(W,{class:b(["buy-whole-btn",{active:c.isWholePiece}]),onClick:o.toggleWholePiece},{default:e((()=>[r(w,{class:"btn-text"},{default:e((()=>[_("整块购买")])),_:1})])),_:1},8,["class","onClick"])])),_:1})])),_:1}),r(W,{class:"total-price-section"},{default:e((()=>[r(W,{class:"spec-title"},{default:e((()=>[_("总价")])),_:1}),r(W,{class:"total-price"},{default:e((()=>[_("¥"+P(o.calculateTotalPrice),1)])),_:1})])),_:1})])),_:1})])),_:1}),r(W,{class:"detail-section card"},{default:e((()=>[r(W,{class:"section-title"},{default:e((()=>[_("商品详情")])),_:1}),r(W,{class:"detail-content"},{default:e((()=>[(d(!0),h(p,null,g(c.product.detailImages,((e,s)=>(d(),t(L,{key:s,src:e,mode:"widthFix",class:"detail-image"},null,8,["src"])))),128)),r(W,{class:"detail-text"},{default:e((()=>[_(P(c.product.description),1)])),_:1})])),_:1})])),_:1}),r(W,{class:"action-bar safe-area-bottom"},{default:e((()=>[r(W,{class:"action-right"},{default:e((()=>[r(W,{class:"add-cart-btn",onClick:o.handleAddToCart},{default:e((()=>[_("加入购物车")])),_:1},8,["onClick"]),r(W,{class:"buy-now-btn",onClick:o.handleBuyNow},{default:e((()=>[_("立即购买")])),_:1},8,["onClick"])])),_:1})])),_:1})])),_:1})}],["__scopeId","data-v-aad36b31"]]);export{F as default};
